<html>
<head>
  <title>Accordion Test</title>
  <script src="http://fb.me/react-0.12.2.js"></script>
  <script src="http://fb.me/JSXTransformer-0.12.2.js"></script>
</head>
<body>
  <div id="content"></div>
  <script type="text/jsx">
    function toggleAccordionTab(tab)
    {
      console.log(tab)
    }

    var data =
    [
      { text:"AccordionTab 1", children:[{text:"Child 1"}, {text:"Child 2"}]}
      ,{ text:"AccordionTab 2", children:[{text:"Child 3"}, {text:"Child 4"}, {text:"Child 5"}]}
      ,{ text:"AccordionTab 3", children:[{text:"Child 6"}, {text:"Child 7"}]}
      ,{ text:"AccordionTab 4", children:[{text:"Child 8"}, {text:"Child 9"}, {text:"Child 10"}]}
    ]

    var Accordion = React.createClass({
      getInitialState: function()
      {
        return { expanded: null };
      },
      toggleTabs: function(expandedTabId)
      {
        console.log(expandedTabId);
        this.setState({expanded:expandedTabId});
      },
      render: function()
      {
        var self = this;
        var clickHandler = this.toggleTabs;
        var accordionTabs = this.props.data.map(function (tab, id)
        {
          return (
            <AccordionTab data={tab} onTabClick={clickHandler} id={id} expanded={self.state.expanded == id}/>
          );
        });
        
        return (
          <div className="accordion">
            {accordionTabs}
          </div>
        );
      }
    });

    var AccordionTab = React.createClass({
      tabClicked: function ()
      {
        console.log(this.props.id);

        var newState = null;
        if(!this.props.expanded)
        {
          newState = this.props.id
        }

        this.props.onTabClick(newState)
      },
      render: function()
      {
        var listItems = this.props.data.children.map(function (tab)
        {
          return (
            <ListItem data={tab}/>
          );
        });

        return (
          <div className="accordionTab">
            <div className="tabHeader" onClick={this.tabClicked}>{this.props.data.text}</div>
            { this.props.expanded ? <div ref="list">{listItems}</div> : null }
          </div>
        )
      }
    });

    var ListItem = React.createClass({
      render: function()
      {
        return (
          <div className="listItem">{this.props.data.text}</div>
        )
      }
    });


    React.render(
      <Accordion data={data}/>,
      document.getElementById('content')
    );
  </script>
</body>
</html>